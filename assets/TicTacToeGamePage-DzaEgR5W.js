import{c,a as H,b as V,r as o,d as Y,u as F,j as e}from"./index-Cn5ZtgLA.js";import{T as A,L as J}from"./TicTacToeBoard-D_outSvX.js";import{S as q}from"./swords-Dk-lNrjZ.js";import"./x-CPx3UtK_.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],K=c("check",B);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],X=c("copy",Q);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ee=c("house",Z);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],O=c("loader",se);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],E=c("play",te);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ne=c("save",ae);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],ie=c("shield",re);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],oe=c("users",le);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],de=c("wifi-off",ce),me=()=>{const{gameId:l,gameName:g,gameInfo:d,playerId:u,players:y,gamePhase:b,gameState:j,createGame:m,joinGame:t,leaveGame:v,notifyLeave:n,setMyUsername:r,performAction:a,startGame:f,playAgain:x,returnToLobby:N,resetSession:k}=H(),{isHost:S,peerConnectionStates:w}=V(),L=o.useMemo(()=>y.find(z=>z.id===u),[y,u]);return{gameId:l,gameName:g,gameInfo:d,playerId:u,players:y,gamePhase:b,gameState:j,isHost:S,peerConnectionStates:w,localPlayer:L,createGame:m,joinGame:t,leaveGame:v,notifyLeave:n,setMyUsername:r,performAction:a,startGame:f,playAgain:x,returnToLobby:N,resetSession:k}},he=()=>{const{gameName:l,gameId:g}=Y(),d=F(),[u,y]=o.useState(!1),[b,j]=o.useState(!1),{gameId:m,gameInfo:t,gamePhase:v,gameState:n,players:r,localPlayer:a,isHost:f,peerConnectionStates:x,joinGame:N,leaveGame:k,setMyUsername:S,startGame:w,returnToLobby:L,performAction:z,resetSession:P}=me(),[h,T]=o.useState(a?.username||""),_=H(s=>s.disconnectionMessage);o.useEffect(()=>{a?.username&&T(a.username)},[a?.username]),o.useEffect(()=>{(async()=>{g&&l&&!m&&!u&&await N(g,l)==="failed"&&d(`/game/${l}`,{replace:!0})})()},[g,l,m,N,u,d]),o.useEffect(()=>{_&&m&&(d(`/game/${l}`,{replace:!0}),P())},[_,m,l,d,P]);const I=async()=>{y(!0),await k(),d("/",{replace:!0})},U=async()=>{y(!0),await k(),d(`/game/${l}`,{replace:!0})},$=()=>{h.trim()&&h.trim()!==a?.username&&S(h.trim())},W=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{j(!0),setTimeout(()=>j(!1),2e3)})},M=o.useMemo(()=>!t||!n?{message:"",isGameOver:!1,isMyTurn:!1}:{message:t.getGameStatus(n,r),isGameOver:t.isGameOver(n),isMyTurn:t.isTurnOf(n,a?.id||"")},[n,t,r,a]),D=o.useMemo(()=>{if(!t||r.length<t.minPlayers)return!1;if(!f)return x.get("p1")==="connected";const s=r.filter(i=>i.id!==a?.id).map(i=>i.id);return s.length===0&&t.minPlayers>1?!1:s.every(i=>x.get(i)==="connected")},[r,t,f,a,x]),R=()=>{if(!t)return null;if(Array.from(x.values()).some(p=>p==="connecting"))return e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-cyan-400 p-2",children:[e.jsx(O,{className:"animate-spin",size:16})," Connecting to player..."]});const i=Array.from(x.values()).some(p=>p==="disconnected"||p==="failed");return r.length<t.minPlayers&&i?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-red-400 p-2",children:[e.jsx(de,{size:16})," Player disconnected. Waiting for a new player."]}):r.length<t.minPlayers?e.jsx("div",{className:"text-center text-sm text-slate-400 p-2",children:"Waiting for another player..."}):null};if(!m||!t||!a)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[e.jsx(O,{className:"animate-spin h-12 w-12 text-cyan-400"}),e.jsx("p",{className:"mt-4 text-xl text-slate-300",children:"Joining Game..."})]});if(v==="post-game"){const{winner:s,playerMap:i}=n,p=i[a.id];let C="",G="text-white";return s==="draw"?(C="It's a Draw!",G="text-yellow-400"):s===p?(C="You Win!",G="text-green-400"):(C="You Lose!",G="text-red-400"),e.jsxs("div",{className:"relative w-full flex items-center justify-center",children:[e.jsx(A,{gameState:n,statusMessage:M.message,isGameOver:!0,isMyTurn:!1,onPerformAction:()=>{},onLeaveGame:I}),e.jsx("div",{className:"absolute inset-0 bg-slate-900/90 backdrop-blur-sm flex flex-col items-center justify-center transition-opacity duration-300 animate-in fade-in",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:`text-6xl font-black ${G}`,children:C}),f&&e.jsxs("div",{className:"mt-8 flex gap-4",children:[e.jsxs("button",{onClick:w,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 font-semibold text-slate-900 bg-cyan-400 rounded-lg hover:bg-cyan-300 transition-transform hover:scale-105",children:[e.jsx(E,{size:20})," Play Again"]}),e.jsxs("button",{onClick:L,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 font-semibold text-slate-300 bg-slate-700 rounded-lg hover:bg-slate-600 transition",children:[e.jsx(ee,{size:20})," Back to Lobby"]})]})]})})]})}return v==="in-game"?e.jsx(A,{gameState:n,statusMessage:M.message,isGameOver:M.isGameOver,isMyTurn:M.isMyTurn,onPerformAction:z,onLeaveGame:I}):e.jsxs("div",{className:"w-full max-w-2xl p-6 md:p-8 space-y-6 bg-slate-800 rounded-2xl shadow-2xl shadow-slate-950/50 border border-slate-700",children:[e.jsx("div",{className:"text-center border-b border-slate-700 pb-4",children:e.jsxs("h2",{className:"text-3xl font-bold text-white",children:[" ",t.displayName," Lobby "]})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-x-8 gap-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-slate-300",children:"Your Settings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"username",className:"text-sm font-medium text-slate-400",children:"Display Name"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{id:"username",type:"text",value:h,onChange:s=>T(s.target.value),onKeyDown:s=>s.key==="Enter"&&$(),className:"flex-grow px-3 py-2 text-white bg-slate-700 border border-slate-600 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"Enter your name..."}),e.jsx("button",{onClick:$,disabled:h.trim()===""||h.trim()===a.username,className:"p-2 text-slate-300 bg-slate-700/50 rounded-md hover:bg-slate-700 disabled:bg-slate-600 disabled:text-slate-500 disabled:cursor-not-allowed transition-colors",children:e.jsx(ne,{size:20})})]})]}),e.jsx("button",{onClick:W,className:`w-full flex items-center justify-center gap-2 px-4 py-2 font-semibold rounded-md transition-colors ${b?"bg-green-600/20 text-green-400":"bg-slate-700/50 text-slate-300 hover:bg-slate-700"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx(K,{size:18})," Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{size:18})," Copy Invite Link"]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"font-semibold text-slate-300 flex items-center gap-2",children:[e.jsx(oe,{size:20})," Players"]}),e.jsxs("div",{className:"space-y-2 p-3 bg-slate-900/50 rounded-md min-h-[120px]",children:[r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-slate-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.id==="p1"?e.jsx(ie,{size:18,className:"text-yellow-400"}):e.jsx(q,{size:18,className:"text-slate-400"}),e.jsxs("span",{className:"font-bold text-slate-100",children:[s.username," ",s.id===a?.id&&e.jsx("span",{className:"text-xs text-cyan-400",children:"(You)"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Score"}),e.jsx("p",{className:"text-xl font-mono font-bold text-cyan-300",children:n?.scores?.[s.id]??0})]})]},s.id)),R()]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-700 flex flex-col md:flex-row-reverse gap-3",children:[f?e.jsxs("button",{onClick:w,className:"w-full md:w-auto flex items-center justify-center gap-2 px-8 py-3 text-lg font-semibold text-slate-900 bg-green-500 rounded-lg hover:bg-green-400 transition transform hover:scale-105 disabled:bg-slate-600 disabled:text-slate-400 disabled:cursor-not-allowed disabled:scale-100",disabled:!D,children:[e.jsx(E,{size:20})," Start Game"]}):e.jsx("p",{className:"w-full text-center text-slate-400 p-3",children:"Waiting for the host to start the game..."}),e.jsxs("button",{onClick:U,className:"w-full md:w-auto flex-shrink-0 flex items-center justify-center gap-2 px-4 py-2 font-semibold text-slate-300 bg-slate-700/50 rounded-lg hover:bg-slate-700/80 hover:text-red-400 transition",children:[e.jsx(J,{size:16})," Leave Lobby"]})]})]})};export{he as default};
